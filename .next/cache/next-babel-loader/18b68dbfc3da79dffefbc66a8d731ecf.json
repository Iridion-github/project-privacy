{"ast":null,"code":"var _jsxFileName = \"/home/iridion/Desktop/Repos/Freelancer/project-privacy/components/fileViewers/pdf/PdfViewer.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport { useLanguage } from '../../../context/siteLanguageContext'; //context\n\nimport { Row, Col, Button, Modal, InputGroup, FormControl } from 'react-bootstrap';\nexport const PdfViewer = function (props) {\n  const siteLanguage = useLanguage(); //context\n\n  const {\n    0: pdf,\n    1: setPdf\n  } = useState(null);\n  const {\n    0: init,\n    1: setInit\n  } = useState(false);\n  const {\n    0: maxPageNum,\n    1: setMaxPageNum\n  } = useState(null);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const {\n    0: zoom,\n    1: setZoom\n  } = useState(1);\n  const {\n    0: destination,\n    1: setDestination\n  } = useState(null);\n\n  const renderPdf = (pdf, targetPage, targetZoom) => {\n    const isMobile = screen.width < 400;\n    if (!targetZoom) targetZoom = 1;\n    setDestination(null);\n    pdf.getPage(targetPage).then(async page => {\n      const canvas = document.getElementById(\"pdf_renderer\");\n      const ctx = canvas.getContext('2d');\n      const viewport = page.getViewport(targetZoom); //grandezza ed altezza del contenitore della pagina\n\n      canvas.width = viewport.width; //grandezza della pagina\n\n      canvas.height = viewport.height; //altezza della pagina\n\n      page.render({\n        canvasContext: ctx,\n        viewport: viewport\n      });\n    });\n  };\n\n  const pdfjsLibSetup = async () => {\n    let view = [];\n\n    if (props.buffer) {\n      view = await new Uint8Array(props.buffer.data);\n    }\n\n    await pdfjsLib.getDocument(props.buffer ? view : props.path).then(async pdfResult => {\n      if (!maxPageNum) {\n        await setMaxPageNum(pdfResult._pdfInfo.numPages);\n      }\n\n      await setPdf(pdfResult);\n    });\n  };\n\n  const goPrevPage = () => {\n    const prevPage = Number(currentPage - 1) > 0 ? Number(currentPage - 1) : 1;\n    setCurrentPage(prevPage);\n    renderPdf(pdf, prevPage, zoom);\n  };\n\n  const goNextPage = () => {\n    const nextPage = Number(currentPage + 1) < maxPageNum ? Number(currentPage + 1) : maxPageNum;\n    setCurrentPage(nextPage);\n    renderPdf(pdf, nextPage, zoom);\n  };\n\n  const handleSetDestination = dest => {\n    if (dest > maxPageNum) dest = maxPageNum;\n    if (dest < 1) dest = 1;\n    setDestination(dest);\n  };\n\n  const handleGoToDestination = () => {\n    setCurrentPage(destination);\n    renderPdf(pdf, destination, zoom);\n  };\n\n  const zoomIn = () => {\n    const newZoomLevel = Number(zoom + 0.2);\n    setZoom(newZoomLevel);\n    renderPdf(pdf, currentPage, newZoomLevel);\n  };\n\n  const zoomOut = () => {\n    const newZoomLevel = Number(zoom - 0.2);\n    setZoom(newZoomLevel);\n    renderPdf(pdf, currentPage, newZoomLevel);\n  };\n\n  const handleClose = () => {\n    setPdf(null);\n    setCurrentPage(1);\n    setInit(false);\n    setMaxPageNum(null);\n    setZoom(1);\n    setDestination(null);\n    props.onClose();\n  };\n\n  useEffect(() => {\n    if (props.show) {\n      if (!pdf) {\n        pdfjsLibSetup();\n      }\n\n      document.title = `Pdf viewer - page: ` + currentPage + ' / ' + maxPageNum;\n\n      if (pdf && !init) {\n        setInit(true);\n        renderPdf(pdf, 1, zoom);\n      }\n    }\n  });\n  return __jsx(Row, {\n    className: \"w-100 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }\n  }, __jsx(Modal, {\n    className: \"justify-content-center\",\n    show: props.show,\n    onHide: handleClose,\n    dialogClassName: \"w-100 pdfviewer-dialog\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    className: \"row w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 11\n    }\n  }, __jsx(Col, {\n    md: {\n      span: 4\n    },\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    id: \"zoom_controls\",\n    className: \"text-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 15\n    }\n  }, __jsx(Button, {\n    size: \"lg\",\n    id: \"zoom_out\",\n    onClick: zoomOut,\n    disabled: zoom <= 1,\n    variant: \"info\",\n    className: \"mr-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, __jsx(\"i\", {\n    className: \"fas fa-search-minus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 19\n    }\n  })), __jsx(Button, {\n    size: \"lg\",\n    id: \"zoom_in\",\n    onClick: zoomIn,\n    disabled: zoom >= 2.5,\n    variant: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }\n  }, __jsx(\"i\", {\n    className: \"fas fa-search-plus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 19\n    }\n  })))), __jsx(Col, {\n    md: {\n      span: 4\n    },\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 15\n    }\n  }, props.filename)), __jsx(Col, {\n    md: {\n      span: 4\n    },\n    className: \"m-0 p-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, __jsx(Row, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, __jsx(Col, {\n    md: {\n      span: 6\n    },\n    className: \"m-0 p-0 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, currentPage, \" / \", maxPageNum), __jsx(Col, {\n    md: {\n      span: 6\n    },\n    className: \"m-0 p-0 text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }, __jsx(Button, {\n    size: \"lg\",\n    onClick: handleClose,\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 19\n    }\n  }, __jsx(\"i\", {\n    className: \"fas fa-times\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 21\n    }\n  }))))))), __jsx(Modal.Body, {\n    className: \"\",\n    style: {\n      padding: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    id: \"my_pdf_viewer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    id: \"canvas_container\",\n    className: \"justify-content-center text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }, __jsx(\"canvas\", {\n    id: \"pdf_renderer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  })))), __jsx(Modal.Footer, {\n    className: \"justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    id: \"navigation_controls\",\n    className: \"w-100 row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }, __jsx(Col, {\n    md: {\n      span: 2\n    },\n    className: \"mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, __jsx(Button, {\n    block: true,\n    id: \"go_previous\",\n    onClick: goPrevPage,\n    disabled: currentPage === 1,\n    variant: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 15\n    }\n  }, __jsx(\"i\", {\n    className: \"fas fa-arrow-left mr-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }), __jsx(\"i\", {\n    className: \"far fa-file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 17\n    }\n  }))), __jsx(Col, {\n    md: {\n      span: 4,\n      offset: 2\n    },\n    className: \"p-0 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, __jsx(InputGroup, {\n    className: \"pl-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  }, __jsx(FormControl, {\n    className: \"mr-2\",\n    id: \"current_page\",\n    value: destination !== null ? destination : currentPage,\n    onChange: event => handleSetDestination(Number(event.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }), __jsx(\"span\", {\n    style: {\n      lineHeight: 2.2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 19\n    }\n  }, \" / \", maxPageNum), __jsx(Button, {\n    size: \"md\",\n    className: \"ml-3 mr-1\",\n    onClick: handleGoToDestination,\n    disabled: destination === null || currentPage === destination,\n    variant: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 17\n    }\n  }, __jsx(\"i\", {\n    className: \"far fa-arrow-alt-circle-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 19\n    }\n  })))), __jsx(Col, {\n    md: {\n      span: 2,\n      offset: 2\n    },\n    className: \"mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }, __jsx(Button, {\n    block: true,\n    id: \"go_next\",\n    onClick: goNextPage,\n    disabled: currentPage >= maxPageNum,\n    variant: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 15\n    }\n  }, __jsx(\"i\", {\n    className: \"far fa-file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 17\n    }\n  }), __jsx(\"i\", {\n    className: \"fas fa-arrow-right ml-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  })))))));\n};","map":{"version":3,"sources":["/home/iridion/Desktop/Repos/Freelancer/project-privacy/components/fileViewers/pdf/PdfViewer.js"],"names":["useState","useEffect","useLanguage","Row","Col","Button","Modal","InputGroup","FormControl","PdfViewer","props","siteLanguage","pdf","setPdf","init","setInit","maxPageNum","setMaxPageNum","currentPage","setCurrentPage","zoom","setZoom","destination","setDestination","renderPdf","targetPage","targetZoom","isMobile","screen","width","getPage","then","page","canvas","document","getElementById","ctx","getContext","viewport","getViewport","height","render","canvasContext","pdfjsLibSetup","view","buffer","Uint8Array","data","pdfjsLib","getDocument","path","pdfResult","_pdfInfo","numPages","goPrevPage","prevPage","Number","goNextPage","nextPage","handleSetDestination","dest","handleGoToDestination","zoomIn","newZoomLevel","zoomOut","handleClose","onClose","show","title","span","filename","padding","offset","event","target","value","lineHeight"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { useLanguage } from '../../../context/siteLanguageContext' //context\nimport {\n  Row,\n  Col,\n  Button,\n  Modal,\n  InputGroup,\n  FormControl\n} from 'react-bootstrap'\n\n\nexport const PdfViewer = function (props) {\n  const siteLanguage = useLanguage() //context\n  const [pdf, setPdf] = useState(null)\n  const [init, setInit] = useState(false)\n  const [maxPageNum, setMaxPageNum] = useState(null)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [zoom, setZoom] = useState(1)\n  const [destination, setDestination] = useState(null)\n\n  const renderPdf = (pdf, targetPage, targetZoom) => {\n    const isMobile = screen.width < 400\n    if (!targetZoom) targetZoom = 1\n    setDestination(null)\n    pdf.getPage(targetPage).then(async page => {\n      const canvas = document.getElementById(\"pdf_renderer\")\n      const ctx = canvas.getContext('2d')\n      const viewport = page.getViewport(targetZoom) //grandezza ed altezza del contenitore della pagina\n      canvas.width = viewport.width //grandezza della pagina\n      canvas.height = viewport.height //altezza della pagina\n      page.render({\n        canvasContext: ctx,\n        viewport: viewport\n      })\n    })\n  }\n\n  const pdfjsLibSetup = async () => {\n    let view = []\n    if (props.buffer) {\n      view = await new Uint8Array(props.buffer.data)\n    }\n    await pdfjsLib.getDocument(props.buffer ? view : props.path).then(async pdfResult => {\n      if (!maxPageNum) {\n        await setMaxPageNum(pdfResult._pdfInfo.numPages)\n      }\n      await setPdf(pdfResult)\n    })\n  }\n\n  const goPrevPage = () => {\n    const prevPage = Number(currentPage - 1) > 0 ? Number(currentPage - 1) : 1\n    setCurrentPage(prevPage)\n    renderPdf(pdf, prevPage, zoom)\n  }\n\n  const goNextPage = () => {\n    const nextPage = Number(currentPage + 1) < maxPageNum ? Number(currentPage + 1) : maxPageNum\n    setCurrentPage(nextPage)\n    renderPdf(pdf, nextPage, zoom)\n  }\n\n  const handleSetDestination = (dest) => {\n    if (dest > maxPageNum) dest = maxPageNum\n    if (dest < 1) dest = 1\n    setDestination(dest)\n  }\n\n  const handleGoToDestination = () => {\n    setCurrentPage(destination)\n    renderPdf(pdf, destination, zoom)\n  }\n\n  const zoomIn = () => {\n    const newZoomLevel = Number(zoom + 0.2)\n    setZoom(newZoomLevel)\n    renderPdf(pdf, currentPage, newZoomLevel)\n  }\n\n  const zoomOut = () => {\n    const newZoomLevel = Number(zoom - 0.2)\n    setZoom(newZoomLevel)\n    renderPdf(pdf, currentPage, newZoomLevel)\n  }\n\n  const handleClose = () => {\n    setPdf(null)\n    setCurrentPage(1)\n    setInit(false)\n    setMaxPageNum(null)\n    setZoom(1)\n    setDestination(null)\n    props.onClose()\n  }\n\n  useEffect(() => {\n    if (props.show) {\n      if (!pdf) {\n        pdfjsLibSetup()\n      }\n      document.title = `Pdf viewer - page: ` + currentPage + ' / ' + maxPageNum\n      if (pdf && !init) {\n        setInit(true)\n        renderPdf(pdf, 1, zoom)\n      }\n    }\n  })\n\n  return (\n    <Row className=\"w-100 m-auto\">\n      <Modal\n        className=\"justify-content-center\"\n        show={props.show}\n        onHide={handleClose}\n        dialogClassName=\"w-100 pdfviewer-dialog\"\n      >\n        <Modal.Header\n          className=\"w-100\"\n        >\n          <Modal.Title className=\"row w-100\">\n            <Col md={{ span: 4 }} className=\"text-center\">\n              <div id={\"zoom_controls\"} className=\"text-left\">\n                <Button\n                  size=\"lg\"\n                  id={\"zoom_out\"}\n                  onClick={zoomOut}\n                  disabled={zoom <= 1}\n                  variant=\"info\"\n                  className=\"mr-1\"\n                >\n                  <i className=\"fas fa-search-minus\"></i>\n                </Button>\n                <Button\n                  size=\"lg\"\n                  id={\"zoom_in\"}\n                  onClick={zoomIn}\n                  disabled={zoom >= 2.5}\n                  variant=\"info\"\n                >\n                  <i className=\"fas fa-search-plus\"></i>\n                </Button>\n              </div>\n            </Col>\n            <Col md={{ span: 4 }} className=\"text-center\">\n              <h2>{props.filename}</h2>\n            </Col>\n            <Col md={{ span: 4 }} className=\"m-0 p-0\">\n              <Row className=\"w-100\">\n                <Col md={{ span: 6 }} className=\"m-0 p-0 text-center\" >\n                  {currentPage} / {maxPageNum}\n                </Col>\n                <Col md={{ span: 6 }} className=\"m-0 p-0 text-right\">\n                  <Button\n                    size=\"lg\"\n                    onClick={handleClose}\n                    variant=\"danger\"\n                  >\n                    <i className=\"fas fa-times\"></i>\n                  </Button>\n                </Col>\n              </Row>\n            </Col>\n          </Modal.Title>\n        </Modal.Header>\n        <Modal.Body className=\"\" style={{ padding: 0 }}>\n          {/* Altra soluzione in caso di seri problemi: html object\n          <object width=\"400\" height=\"400\" data={props.path} type=\"application/pdf\"></object>\n          */}\n          <div id={\"my_pdf_viewer\"}>\n            <div id={\"canvas_container\"} className=\"justify-content-center text-center\">\n              <canvas id={\"pdf_renderer\"}></canvas>\n            </div>\n          </div>\n        </Modal.Body>\n        <Modal.Footer className=\"justify-content-center\">\n          <div id={\"navigation_controls\"} className=\"w-100 row\">\n            <Col md={{ span: 2 }} className=\"mb-2\">\n              <Button\n                block\n                id={\"go_previous\"}\n                onClick={goPrevPage}\n                disabled={currentPage === 1}\n                variant=\"info\"\n              >\n                <i className=\"fas fa-arrow-left mr-1\"></i>\n                <i className=\"far fa-file\"></i>\n              </Button>\n            </Col>\n            <Col md={{ span: 4, offset: 2 }} className=\"p-0 mb-2\">\n              <InputGroup className=\"pl-4\">\n                <FormControl\n                  className=\"mr-2\"\n                  id={\"current_page\"}\n                  value={destination !== null ? destination : currentPage}\n                  onChange={(event) => handleSetDestination(Number(event.target.value))}\n                /><span style={{ lineHeight: 2.2 }}> / {maxPageNum}</span>\n                <Button\n                  size=\"md\"\n                  className=\"ml-3 mr-1\"\n                  onClick={handleGoToDestination}\n                  disabled={(destination === null || currentPage === destination)}\n                  variant=\"info\"\n                >\n                  <i className=\"far fa-arrow-alt-circle-right\"></i>\n                </Button>\n              </InputGroup>\n            </Col>\n            <Col md={{ span: 2, offset: 2 }} className=\"mb-2\">\n              <Button\n                block\n                id={\"go_next\"}\n                onClick={goNextPage}\n                disabled={currentPage >= maxPageNum}\n                variant=\"info\"\n              >\n                <i className=\"far fa-file\"></i>\n                <i className=\"fas fa-arrow-right ml-1\"></i>\n              </Button>\n            </Col>\n          </div>\n        </Modal.Footer>\n      </Modal>\n    </Row>\n  )\n}"]},"metadata":{},"sourceType":"module"}